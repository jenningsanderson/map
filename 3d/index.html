<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<title>3d Map for Stuff</title>
	<meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
	<link href="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.css" rel="stylesheet">
	<link href="https://api.mapbox.com/mapbox-assembly/v1.2.1/assembly.min.css" rel="stylesheet">
	<script src="https://api.mapbox.com/mapbox-gl-js/v2.4.1/mapbox-gl.js"></script>
	<script async defer src="https://api.mapbox.com/mapbox-assembly/v1.2.1/assembly.js"></script>
	<style>
		body { margin: 0; padding: 0; }
		#map { position: absolute; top: 0; bottom: 0; width: 100%; }
		.marker {
			display: block;
			border: 2px solid white;
			border-radius: 50%;
			cursor: pointer;
			padding: 0;
		}
		#timeline{
			position: absolute;
			top: 5; left: 5;
			width: 100px;
			padding: 10px;
			background: rgba(100,100,100,0.9);
			border: 2px solid white;
			border-radius: 3px;
			color:  white;
			font-family: sans-serif;
		}
		#date{
			border-top: 1px solid grey;
			padding-top: 5px;
			margin-bottom: 10px;
		}
	</style>
</head>
<body>
<div id="map"></div>
<div id='timeline'>
	<h3>Scenes</h3>
	
	<button id='1' class='btn btn--s mt12' onclick="fly('15.78/46.464877/-111.241158/-76/71')">Big Belt Hut</button>
	<button id='2' class='btn btn--s mt12' onclick="fly('11.19/46.4947/-111.2244/-49.2/29')">Big Belt Mtns</button>
	<button id='3' class='btn btn--s mt12' onclick="fly('14.61/47.19075/-113.34893/-36.8/74')">YurtSki</button>
	
</div>
 <script>

 	function fly(url){
 		var parts = url.split("/").map(function(m){return Number(m)})
 		console.log(parts)
 		map.flyTo({
			center : [parts[2], parts[1]],
			zoom: parts[0],
			bearing: parts[3],
			pitch: parts[4],
			speed: 0.4, // make the flying just shy of medium.
			curve: 1,
			easing: (t) => t,
			// this animation is considered essential with respect to prefers-reduced-motion
			essential: true
		});
 	}

	mapboxgl.accessToken = 'pk.eyJ1IjoiamVubmluZ3NhbmRlcnNvbiIsImEiOiIzMHZndnpvIn0.PS-j7fRK3HGU7IE8rbLT9A';
	const map = new mapboxgl.Map({
		container: 'map',
		zoom: 12.9,
		center: [-111.23, 46.47],
		pitch: 67,
		bearing: -68,
		hash: true,
		style: 'mapbox://styles/mapbox-map-design/ckhqrf2tz0dt119ny6azh975y',
		attributionControl: false
	}).addControl(new mapboxgl.AttributionControl({
		// customAttribution: ''
	}));;

	 
	map.on('load', () => {
			map.addSource('mapbox-dem', {
			'type': 'raster-dem',
			'url': 'mapbox://mapbox.mapbox-terrain-dem-v1',
			'tileSize': 512,
			'maxzoom': 14
		});
		
		// add the DEM source as a terrain layer with exaggerated height
		map.setTerrain({ 'source': 'mapbox-dem', 'exaggeration': 1.1 });
 
		// add a sky layer that will show when the map is highly pitched
		map.addLayer({
			'id': 'sky',
			'type': 'sky',
			'paint': {
				'sky-type': 'atmosphere',
				'sky-atmosphere-sun': [0.0, 0.0],
				'sky-atmosphere-sun-intensity': 15
			}
		});

		map.addLayer({
			'id':'galt_properties',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'galt_properties.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'pink',
				'fill-opacity':0.7
			}
		})

		map.addLayer({
			'id':'allowed_yearlong',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'morrell/snowmobile_allowed.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'green',
				'fill-opacity':0.7
			}
		})

		map.addLayer({
			'id':'wilderness',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'morrell/wilderness.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'orangered',
				'fill-opacity':0.7
			}
		})

		map.addLayer({
			'id':'yearlong_restricted',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'morrell/yearlong_snowmobile_restricted.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'red',
				'fill-opacity':0.7
			}
		})

		map.addLayer({
			'id':'aoi',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'morrell/area_of_interest.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'pink',
				'fill-opacity':0.7
			}
		})
		map.addLayer({
			'id':'morrell_road',
			'type':'fill',
			'source':{
				'type':'geojson',
				'data':'morrell/FS_4365.geojson'
			},
			'layout':{
				'visibility':'visible'
			},
			'paint':{
				'fill-color':'lightgreen',
				'fill-opacity':0.7
			}
		})


		 map.addLayer({
		 	'id':'bbh_aerial',
		 	'type':'raster',
		 	'source':{
		 		"type": "raster",
    			"url": "mapbox://jenningsanderson.bbh_aerial",
    			"tileSize": 256
		 	}
		 })

		const el = document.createElement('div');
		const width  = 100; //marker.properties.iconSize[0];
		const height = 100; //marker.properties.iconSize[1];
		el.className = 'marker';
		el.style.backgroundImage = `url(bbh2.png)`;
		el.style.width = `${width}px`;
		el.style.height = `${height}px`;
		el.style.backgroundSize = '100%';
		 
		// Add markers to the map.
		function addMarker(){
			const marker = new mapboxgl.Marker(el)
				.setLngLat([-111.24194072,46.46461690])
				.addTo(map);
		}

	});

</script>
 </body>
</html>